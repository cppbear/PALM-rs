// Answer 0

#[test]
fn test_new_with_valid_key_and_nonce() {
    let key: [u8; 32] = [
        0x00, 0x01, 0x02, 0x03,
        0x04, 0x05, 0x06, 0x07,
        0x08, 0x09, 0x0A, 0x0B,
        0x0C, 0x0D, 0x0E, 0x0F,
        0x10, 0x11, 0x12, 0x13,
        0x14, 0x15, 0x16, 0x17,
        0x18, 0x19, 0x1A, 0x1B,
        0x1C, 0x1D, 0x1E, 0x1F,
    ];
    let nonce: &[u8] = &[0x00; 12];
    let chacha_instance = ChaCha::new(&key, nonce);
    assert_eq!(chacha_instance.b, vec128_storage::default());
    assert_eq!(chacha_instance.c, vec128_storage::default());
    assert_eq!(chacha_instance.d, vec128_storage::default());
}

#[test]
fn test_new_with_empty_nonce() {
    let key: [u8; 32] = [
        0x00, 0x01, 0x02, 0x03,
        0x04, 0x05, 0x06, 0x07,
        0x08, 0x09, 0x0A, 0x0B,
        0x0C, 0x0D, 0x0E, 0x0F,
        0x10, 0x11, 0x12, 0x13,
        0x14, 0x15, 0x16, 0x17,
        0x18, 0x19, 0x1A, 0x1B,
        0x1C, 0x1D, 0x1E, 0x1F,
    ];
    let nonce: &[u8] = &[]; // should still initialize
    let chacha_instance = ChaCha::new(&key, nonce);
    assert_eq!(chacha_instance.b, vec128_storage::default());
    assert_eq!(chacha_instance.c, vec128_storage::default());
    assert_eq!(chacha_instance.d, vec128_storage::default());
}

#[test]
fn test_new_with_nonce_of_maximum_length() {
    let key: [u8; 32] = [
        0x00, 0x01, 0x02, 0x03,
        0x04, 0x05, 0x06, 0x07,
        0x08, 0x09, 0x0A, 0x0B,
        0x0C, 0x0D, 0x0E, 0x0F,
        0x10, 0x11, 0x12, 0x13,
        0x14, 0x15, 0x16, 0x17,
        0x18, 0x19, 0x1A, 0x1B,
        0x1C, 0x1D, 0x1E, 0x1F,
    ];
    let nonce: &[u8] = &[0x01; 24]; // maximum length nonce
    let chacha_instance = ChaCha::new(&key, nonce);
    assert_eq!(chacha_instance.b, vec128_storage::default());
    assert_eq!(chacha_instance.c, vec128_storage::default());
    assert_eq!(chacha_instance.d, vec128_storage::default());
}

#[should_panic]
#[test]
fn test_new_with_invalid_key_length() {
    let key: [u8; 32] = [
        0x00, 0x01, 0x02, 0x03,
        0x04, 0x05, 0x06, 0x07,
        0x08, 0x09, 0x0A, 0x0B,
        0x0C, 0x0D, 0x0E, 0x0F,
        0x10, 0x11, 0x12, 0x13,
        0x14, 0x15, 0x16, 0x17,
        0x18, 0x19, 0x1A, 0x1B,
        0x1C, 0x1D, 0x1E, 0x1F,
    ];
    let nonce: &[u8] = &[0x00; 8]; // nonce is valid, but key length is invalid
    let _ = ChaCha::new(&key, nonce);
}

