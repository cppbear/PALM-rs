{
  "name": "serde::__private::de::content::<__private::de::content::TaggedContentVisitor<T> as de::Visitor<'de>>::visit_map",
  "name_with_impl": "serde::__private::de::content::{impl#10}::visit_map",
  "mod_info": {
    "name": "__private::de::content",
    "loc": "serde/src/private/de.rs:198:1:2358:2"
  },
  "visible": true,
  "loc": "serde/src/private/de.rs:880:9:907:10",
  "fn_tests": [
    {
      "chain_id": 2,
      "prompt_conds": [
        "// constraint: map.next_key_seed(TagOrContentVisitor::new(self.tag_name)) matches Ok(val) is true\n",
        "// constraint: map.next_value() matches Ok(val) is true\n",
        "// constraint: let Some(k) = tri!(map.next_key_seed(TagOrContentVisitor::new(self.tag_name))) is true\n",
        "// constraint: tag matches Some(tag) is true\n",
        "// expected return value/type: Ok((tag, Content::Map(vec)))\n"
      ],
      "input_infer": "",
      "answers": [
        {
          "uses": [
            "use std::collections::HashMap;"
          ],
          "has_test_mod": false,
          "common": [],
          "chain_tests": [
            {
              "attrs": [],
              "prefix": [],
              "oracles": [],
              "codes": [
                [
                  "{",
                  "    use std::collections::HashMap;",
                  "    ",
                  "    struct MockMap {",
                  "        current_key: usize,",
                  "        keys: Vec<TagOrContent<'static>>,",
                  "        values: Vec<Content<'static>>,",
                  "    }",
                  "",
                  "    impl MockMap {",
                  "        fn new(keys: Vec<TagOrContent<'static>>, values: Vec<Content<'static>>) -> Self {",
                  "            MockMap {",
                  "                current_key: 0,",
                  "                keys,",
                  "                values,",
                  "            }",
                  "        }",
                  "",
                  "        fn next_key_seed(&mut self, _visitor: TagOrContentVisitor) -> Option<Result<TagOrContent<'static>, Error>> {",
                  "            if self.current_key < self.keys.len() {",
                  "                let key = self.keys[self.current_key].clone();",
                  "                self.current_key += 1;",
                  "                Some(Ok(key))",
                  "            } else {",
                  "                None",
                  "            }",
                  "        }",
                  "",
                  "        fn next_value(&mut self) -> Result<Content<'static>, Error> {",
                  "            if self.current_key > 0 && (self.current_key - 1) < self.values.len() {",
                  "                Ok(self.values[self.current_key - 1].clone())",
                  "            } else {",
                  "                Err(Error::custom(\"no value available\"))",
                  "            }",
                  "        }",
                  "    }",
                  "",
                  "    impl MapAccess<'static> for MockMap {",
                  "        type Error = Self::Error;  ",
                  " ",
                  "        fn next_key_seed<K>(&mut self, _: K) -> Result<Option<Self::Key>, Self::Error> where K: DeserializeSeed<'static> {",
                  "            self.next_key_seed(TagOrContentVisitor::new(\"tag\"))",
                  "        }",
                  "",
                  "        fn next_value<V>(&mut self) -> Result<Self::Value, Self::Error> where V: Deserialize<'static> {",
                  "            self.next_value()",
                  "        }",
                  "    }",
                  "",
                  "    let mut mock_map = MockMap::new(",
                  "        vec![",
                  "            TagOrContent::Tag,",
                  "            TagOrContent::Content(Content::String(\"key1\".to_string())),",
                  "        ],",
                  "        vec![",
                  "            Content::String(\"value1\".to_string()),",
                  "            Content::String(\"value2\".to_string()),",
                  "        ]",
                  "    );",
                  "",
                  "    let visitor = TaggedContentVisitor {",
                  "        tag_name: \"tag\",",
                  "        expecting: \"Expecting a tag or content\",",
                  "        value: PhantomData::<T>,",
                  "    };",
                  "",
                  "    let result = visitor.visit_map(mock_map);",
                  "",
                  "    assert!(result.is_ok());",
                  "    if let Ok((tag, content)) = result {",
                  "        assert!(!matches!(tag, Content::None));",
                  "        if let Content::Map(vec) = content {",
                  "            assert_eq!(vec.len(), 1);",
                  "            assert_eq!(vec[0].0, Content::String(\"key1\".to_string()));",
                  "            assert_eq!(vec[0].1, Content::String(\"value1\".to_string()));",
                  "        }",
                  "    }",
                  "}"
                ]
              ],
              "can_compile": [
                {
                  "Err": "   Compiling serde v1.0.219 (/home/abezbm/rust-utgen-test-crates-new/serde/serde)\nerror[E0412]: cannot find type `Error` in this scope\n    --> serde/src/private/de.rs:2386:108\n     |\n2386 |         fn next_key_seed(&mut self, _visitor: TagOrContentVisitor) -> Option<Result<TagOrContent<'static>, Error>> {\n     |                                                                                                            ^^^^^ not found in this scope\n     |\nhelp: consider importing one of these items\n     |\n2361 +    use crate::__private::de::Error;\n     |\n2361 +    use crate::__private::de::error::Error;\n     |\n2361 +    use crate::__private::doc::Error;\n     |\n2361 +    use crate::__private::fmt::Error;\n     |\n       and 7 other candidates\n\nerror[E0412]: cannot find type `Error` in this scope\n    --> serde/src/private/de.rs:2396:62\n     |\n2396 |         fn next_value(&mut self) -> Result<Content<'static>, Error> {\n     |                                                              ^^^^^ not found in this scope\n     |\nhelp: consider importing one of these items\n     |\n2361 +    use crate::__private::de::Error;\n     |\n2361 +    use crate::__private::de::error::Error;\n     |\n2361 +    use crate::__private::doc::Error;\n     |\n2361 +    use crate::__private::fmt::Error;\n     |\n       and 7 other candidates\n\nerror[E0433]: failed to resolve: use of undeclared type `Error`\n    --> serde/src/private/de.rs:2400:21\n     |\n2400 |                 Err(Error::custom(\"no value available\"))\n     |                     ^^^^^ use of undeclared type `Error`\n     |\nhelp: consider importing one of these items\n     |\n2361 +    use crate::__private::de::Error;\n     |\n2361 +    use crate::__private::de::error::Error;\n     |\n2361 +    use crate::__private::doc::Error;\n     |\n2361 +    use crate::__private::fmt::Error;\n     |\n       and 7 other candidates\n\nerror[E0412]: cannot find type `T` in this scope\n    --> serde/src/private/de.rs:2431:30\n     |\n2431 |         value: PhantomData::<T>,\n     |                              ^ not found in this scope\n     |\nhelp: consider importing this struct\n     |\n2361 +    use crate::actually_private::T;\n     |\n\nwarning: unused import: `std::collections::HashMap`\n    --> serde/src/private/de.rs:2369:9\n     |\n2369 |     use std::collections::HashMap;\n     |         ^^^^^^^^^^^^^^^^^^^^^^^^^\n     |\n     = note: `#[warn(unused_imports)]` on by default\n\nerror[E0220]: associated type `Key` not found for `Self`\n    --> serde/src/private/de.rs:2408:69\n     |\n2408 |         fn next_key_seed<K>(&mut self, _: K) -> Result<Option<Self::Key>, Self::Error> where K: DeserializeSeed<'static> {\n     |                                                                     ^^^ help: `Self` has the following associated type: `Error`\n\nerror[E0220]: associated type `Value` not found for `Self`\n    --> serde/src/private/de.rs:2412:53\n     |\n2412 |         fn next_value<V>(&mut self) -> Result<Self::Value, Self::Error> where V: Deserialize<'static> {\n     |                                                     ^^^^^ help: `Self` has the following associated type: `Error`\n\nerror[E0275]: overflow evaluating the requirement `<MockMap as de::MapAccess<'static>>::Error == _`\n    --> serde/src/private/de.rs:2406:22\n     |\n2406 |         type Error = Self::Error;  \n     |                      ^^^^^^^^^^^\n\nSome errors have detailed explanations: E0220, E0275, E0412, E0433.\nFor more information about an error, try `rustc --explain E0220`.\nwarning: `serde` (lib test) generated 1 warning\nerror: could not compile `serde` (lib test) due to 7 previous errors; 1 warning emitted\n"
                }
              ],
              "repaired": [
                true
              ]
            }
          ]
        }
      ]
    },
    {
      "chain_id": 3,
      "prompt_conds": [
        "// constraint: map.next_key_seed(TagOrContentVisitor::new(self.tag_name)) matches Ok(val) is true\n",
        "// constraint: map.next_value() matches Ok(val) is true\n",
        "// constraint: let Some(k) = tri!(map.next_key_seed(TagOrContentVisitor::new(self.tag_name))) is true\n",
        "// constraint: tag matches None is true\n",
        "// constraint: tag matches None is true\n",
        "// expected return value/type: Err(de::Error::missing_field(self.tag_name))\n"
      ],
      "input_infer": "",
      "answers": [
        {
          "uses": [],
          "has_test_mod": false,
          "common": [],
          "chain_tests": []
        }
      ]
    },
    {
      "chain_id": 4,
      "prompt_conds": [
        "// constraint: map.next_key_seed(TagOrContentVisitor::new(self.tag_name)) matches Ok(val) is true\n",
        "// constraint: map.next_value() matches Ok(val) is true\n",
        "// constraint: let Some(k) = tri!(map.next_key_seed(TagOrContentVisitor::new(self.tag_name))) is true\n",
        "// constraint: k matches TagOrContent::Content(k) is true\n",
        "// constraint: map.next_value() matches Err(err) is true\n",
        "// expected return value/type: Err(err)\n"
      ],
      "input_infer": "",
      "answers": [
        {
          "uses": [],
          "has_test_mod": false,
          "common": [],
          "chain_tests": []
        }
      ]
    },
    {
      "chain_id": 5,
      "prompt_conds": [
        "// constraint: map.next_key_seed(TagOrContentVisitor::new(self.tag_name)) matches Ok(val) is true\n",
        "// constraint: map.next_value() matches Ok(val) is true\n",
        "// constraint: let Some(k) = tri!(map.next_key_seed(TagOrContentVisitor::new(self.tag_name))) is true\n",
        "// constraint: k matches TagOrContent::Content(k) is true\n",
        "// constraint: map.next_value() matches Ok(val) is true\n",
        "// constraint: map.next_value() matches Ok(val) is true\n",
        "// constraint: map.next_key_seed(TagOrContentVisitor::new(self.tag_name)) matches Err(err) is true\n",
        "// expected return value/type: Err(err)\n"
      ],
      "input_infer": "",
      "answers": [
        {
          "uses": [],
          "has_test_mod": false,
          "common": [],
          "chain_tests": []
        }
      ]
    },
    {
      "chain_id": 6,
      "prompt_conds": [
        "// constraint: map.next_key_seed(TagOrContentVisitor::new(self.tag_name)) matches Ok(val) is true\n",
        "// constraint: map.next_value() matches Ok(val) is true\n",
        "// constraint: let Some(k) = tri!(map.next_key_seed(TagOrContentVisitor::new(self.tag_name))) is true\n",
        "// constraint: k matches TagOrContent::Tag is true\n",
        "// constraint: k matches TagOrContent::Tag is true\n",
        "// constraint: tag.is_some() is true\n",
        "// expected return value/type: Err(de::Error::duplicate_field(self.tag_name))\n"
      ],
      "input_infer": "",
      "answers": [
        {
          "uses": [],
          "has_test_mod": false,
          "common": [],
          "chain_tests": []
        }
      ]
    },
    {
      "chain_id": 7,
      "prompt_conds": [
        "// constraint: map.next_key_seed(TagOrContentVisitor::new(self.tag_name)) matches Ok(val) is true\n",
        "// constraint: map.next_value() matches Ok(val) is true\n",
        "// constraint: let Some(k) = tri!(map.next_key_seed(TagOrContentVisitor::new(self.tag_name))) is true\n",
        "// constraint: k matches TagOrContent::Tag is true\n",
        "// constraint: k matches TagOrContent::Tag is true\n",
        "// constraint: tag.is_some() is false\n",
        "// constraint: map.next_value() matches Err(err) is true\n",
        "// expected return value/type: Err(err)\n"
      ],
      "input_infer": "",
      "answers": [
        {
          "uses": [],
          "has_test_mod": false,
          "common": [],
          "chain_tests": []
        }
      ]
    },
    {
      "chain_id": 8,
      "prompt_conds": [
        "// constraint: map.next_key_seed(TagOrContentVisitor::new(self.tag_name)) matches Ok(val) is true\n",
        "// constraint: map.next_value() matches Ok(val) is true\n",
        "// constraint: let Some(k) = tri!(map.next_key_seed(TagOrContentVisitor::new(self.tag_name))) is true\n",
        "// constraint: k matches TagOrContent::Tag is true\n",
        "// constraint: k matches TagOrContent::Tag is true\n",
        "// constraint: tag.is_some() is false\n",
        "// constraint: map.next_value() matches Ok(val) is true\n",
        "// constraint: map.next_value() matches Ok(val) is true\n",
        "// constraint: map.next_key_seed(TagOrContentVisitor::new(self.tag_name)) matches Err(err) is true\n",
        "// expected return value/type: Err(err)\n"
      ],
      "input_infer": "",
      "answers": [
        {
          "uses": [],
          "has_test_mod": false,
          "common": [],
          "chain_tests": []
        }
      ]
    }
  ]
}